---
title: "The divergence theorem"
---

::: {.hidden}
 \providecommand{\vv}[1]{{\mathbf{#1}}}
 \providecommand{\pd}[2]{{\frac{\partial #1}{\partial #2}}}
:::

The divergence theorem is similar to Stokes' theorem, but it relates volumes and surfaces rather than surfaces and curves. As the name suggests, it uses the divergence:
$$
\int_V \nabla\cdot \vv{F}(\vv{r}) dV = \int_{\partial V} \vv{F}(\vv{r})\cdot d\vv{S}.
$$

:::{.callout-important}
The volume integral of the divergence of a vector field over a volume $V$ is the flux integral of the vector field over $\partial V$.
:::

As you may be able to guess, $\partial V$ is the boundary of the volume $V$, with the normal facing out. Again, we may need to do the boundary in more than one piece.

![](figures/f14.jpg){width=50%}

### Example
Let $V$ be the solid cylinder $x^2+y^2\leq 1$, $0\leq z \leq 2$. Calculate, both directly and using the divergence theorem, the volume integral
$$
\int_V 2z\, dV
$$

::: {.callout-tip collapse="true"}
## Solution

### Directly
Since $V$ is the cylinder $x^2 + y^2 \leq 1$, $0 \leq z \leq 2$, we can use cylindrical coordinates:
$$
x = \rho\cos\phi,\quad y = \rho\sin\phi,\quad z = z,\quad 0 \leq \rho \leq 1,\ 0 \leq \phi < 2\pi,\ 0 \leq z \leq 2
$$

The volume element is $dV = \rho\,d\rho\,d\phi\,dz$.

So,
$$
\begin{aligned}
\int_V 2z\,dV &= \int_{0}^2 dz\int_{0}^1 d\rho \int_{0}^{2\pi} d\phi 2z\rho\\
&= \left(\int_{0}^2 2z  dz\right)\left( \int_{0}^1 \rho\,d\rho \right) \left( \int_{0}^{2\pi} d\phi \right) \\&= 4\pi.
\end{aligned}
$$

### Divergence theorem
To apply the divergence theorem, we need to find some $\vv{F}$ such that $\nabla\cdot\vv{F}=2z$.

$$\vv{F} = [0,0,z^2]$$
works (more on this next week).
So we need to calculate
$$
\int_{\partial V} [0,0,z^2]\cdot d\vv{S}
$$

In this case, $\partial V$ has three parts that we'll call $S_1$, $S_2$ and $S_3$.

![](figures/f15.jpg){width=30%}

On the base $S_1$, the field $\vv{F}$ is zero because $z=0$, so 
$$\int_{S_1} [0,0,z^2]\cdot d\vv{S} = 0$$

On the curved surface $S_2$, the normal $\hat\vv{n}$ is horizontal, and the field $\vv{F}$ is only in the $z$ direction, so $\vv{F}\cdot d\vv{S}=0$, so
$$\int_{S_2} [0,0,z^2]\cdot d\vv{S} = 0$$

On the top $S_3$, $\vv{F} = [0,0,4]$ which is parallel to the outward-pointing normal $\hat{\vv{n}}$, so the surface integral gives
$$\int_{S_3} \vv{F}\cdot d\vv{S} = \int_{S_3} [0,0,4]\cdot \hat{\vv{n}}\, dS = 4 \int_{S_3} dS = 4\pi$$
because $\int_{S_3} dS$ is just the area of the circle.

So the divergence theorem gives us $\int_V 2z\,dV = 4\pi$, as before.
:::

# Green's identities
These two results are easy to prove once you know the divergence theorem, and they turn out to be helpful in many situations in physics. They also give good insight into how the divergence theorem can be used.

## Green's first identity
Green's first identity states that, for any scalar fields $f$ and $g$,
$$
\int_V \left(g\Delta f + \nabla f \cdot \nabla g\right)dV = \int_{\partial V} g\nabla f \cdot d\vv{S}.
$$

To prove this, we obviously need to use the divergence theorem. It's not clear how we can use that on the left-hand side, so let's start with the right-hand side and use the product rule:
$$
\begin{aligned}
\int_{\partial V} g\nabla f \cdot d\vv{S} &= \int_{V} \nabla \cdot \left(g\nabla f\right) dV
\\ &= \int_{V} \left(\nabla g \cdot \nabla f + g\nabla\cdot\nabla f \right) dV
\end{aligned}
$$
which is exactly what we wanted, when we remember that $\Delta f = \nabla\cdot\nabla f$.

## Green's second identity
Green's second identity states that, for any scalar fields $f$ and $g$,
$$
\int_V \left(f\Delta g - g\Delta f\right)dV = \int_{\partial V} \left(f\nabla g - g\nabla f\right) \cdot d\vv{S}.
$$
You can get this one from subtracting the first identity from itself with $f$ and $g$ swapped.

This one is quite handy when you rearrange it:
$$
\int_V f\Delta g\ dV = \int_{\partial V} \left(f\nabla g - g\nabla f\right) \cdot d\vv{S} + \int_V g\Delta f\ dV.
$$
This is basically a form of integration by parts for the Laplacian $\Delta$.